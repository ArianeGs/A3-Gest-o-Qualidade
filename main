import tkinter as tk
from tkinter import ttk
from tkinter import messagebox

class Dono:
    def __init__(self, nome, sobrenome, cpf, numero_contato):
        self.nome = nome
        self.sobrenome = sobrenome
        self.cpf = cpf
        self.numero_contato = numero_contato

class Animal:
    def __init__(self, nome, especie, dono, sexo, idade, raca):
        self.nome = nome
        self.especie = especie
        self.sexo = sexo
        self.raca = raca
        self.idade = idade
        self.dono = dono

class AtendimentoVeterinario:
    def __init__(self, animal, data, sintomas, diagnostico):
        self.animal = animal
        self.data = data
        self.sintomas = sintomas
        self.diagnostico = diagnostico

class CRUDApp:
    def __init__(self, root):
        self.root = root
        self.root.title("CRUD de Donos, Animais e Atendimento Veterinário")

        # Crie uma guia de notebook para separar as funcionalidades
        self.tab_control = ttk.Notebook(self.root)
        self.tab_dono = ttk.Frame(self.tab_control)
        self.tab_animal = ttk.Frame(self.tab_control)
        self.tab_atendimento = ttk.Frame(self.tab_control)
        self.tab_control.add(self.tab_dono, text="Adotantes")
        self.tab_control.add(self.tab_animal, text="Animais")
        self.tab_control.add(self.tab_atendimento, text="Atendimento Veterinário")
        self.tab_control.pack(expand=1, fill="both")
        
        # Inicialize listas para armazenar objetos
        self.donos = []
        self.animais = []
        self.atendimentos = []

        # Crie a interface para Donos
        self.criar_interface_dono()

        # Crie a interface para Animais
        self.criar_interface_animal()

        # Crie a interface para Atendimento Veterinário
        self.criar_interface_atendimento()

    def cadastrar_dono(self):
        nome = self.nome_entry.get()
        sobrenome = self.sobrenome_entry.get()
        cpf = self.cpf_entry.get()
        numero_contato = self.numero_contato_entry.get()

        dono = Dono(nome, sobrenome, cpf, numero_contato)
        self.donos.append(dono)

        self.nome_entry.delete(0, "end")
        self.sobrenome_entry.delete(0, "end")
        self.cpf_entry.delete(0, "end")
        self.numero_contato_entry.delete(0, "end")

        messagebox.showinfo("Cadastro de Dono", "Dono cadastrado com sucesso!")

    def deletar_adotante(self):
        cpf = self.cpf_entry.get()
        dono = next((d for d in self.donos if d.cpf == cpf), None)
        if dono:
            self.donos.remove(dono)
            self.cpf_entry.delete(0, "end")
            messagebox.showinfo("Remoção de Adotante", "Adotante removido com sucesso!")
        else:
            messagebox.showerror("Erro", "Adotante não encontrado. Verifique o CPF do Adotante.")
            
    def cadastrar_animal(self):
        nome = self.nome_animal_entry.get()
        especie = self.especie_entry.get()
        sexo = self.sexo_entry.get()
        raca = self.raca_entry.get()
        idade = self.idade_entry.get()
        cpf_dono = self.dono_entry.get()

        dono = next((d for d in self.donos if d.cpf == cpf_dono), None)

        if dono:
            animal = Animal(nome, especie, dono, sexo, idade, raca)
            self.animais.append(animal)
            self.nome_animal_entry.delete(0, "end")
            self.especie_entry.delete(0, "end")
            self.sexo_entry.delete(0, "end")
            self.raca_entry.delete(0, "end")
            self.idade_entry.delete(0, "end")
            self.dono_entry.delete(0, "end")
            messagebox.showinfo("Cadastro de Animal", "Animal cadastrado com sucesso!")
        else:
            messagebox.showerror("Erro", "Adotante não encontrado. Verifique o CPF do Adotante.")

    def cadastrar_atendimento(self):
        nome_animal = self.animal_atendimento_entry.get()
        data = self.data_entry.get()
        sintomas = self.sintomas_entry.get()
        diagnostico = self.diagnostico_entry.get()

        animal = next((a for a in self.animais if a.nome == nome_animal), None)

        if animal:
            atendimento = AtendimentoVeterinario(animal, data, sintomas, diagnostico)
            self.atendimentos.append(atendimento)
            self.animal_atendimento_entry.delete(0, "end")
            self.data_entry.delete(0, "end")
            self.sintomas_entry.delete(0, "end")
            self.diagnostico_entry.delete(0, "end")
            messagebox.showinfo("Cadastro de Atendimento", "Atendimento cadastrado com sucesso!")
        else:
            messagebox.showerror("Erro", "Animal não encontrado. Verifique o nome do animal.")
    
    def get_lista_donos(self):
        return [(d.nome, d.sobrenome, d.cpf, d.numero_contato) for d in self.donos]

    def get_lista_animais(self):
        return [(a.nome, a.especie, a.sexo, a.idade, a.raca, a.dono.cpf) for a in self.animais]

    def get_lista_atendimentos(self):
        return [(at.animal.nome, at.animal.sexo, at.animal.especie, at.animal.raca, at.data, at.sintomas, at.diagnostico) for at in self.atendimentos]
    
    def visualizar_animais_por_cpf(self):
        cpf = self.cpf_entry.get()
        dono = next((d for d in self.donos if d.cpf == cpf), None)
        
        if dono:
            animais_dono = [(a.nome, a.raca) for a in self.animais if a.dono == dono]
            if animais_dono:
                animais_info = "\n".join([f"Nome: {nome}, Raça: {raca}" for nome, raca in animais_dono])
                messagebox.showinfo("Animais do Adotante", f"Animais vinculados ao CPF {cpf}:\n{animais_info}")
            else:
                messagebox.showinfo("Animais do Adotante", f"Nenhum animal vinculado ao CPF {cpf}.")
        else:
            messagebox.showerror("Erro", "Adotante não encontrado. Verifique o CPF do Adotante.")

    def visualizar_atendimentos_por_animal_e_dono(self):
        nome_animal = self.nome_animal_atendimento_entry.get()
        cpf_dono = self.cpf_dono_atendimento_entry.get()
        animal = next((a for a in self.animais if a.nome == nome_animal and a.dono.cpf == cpf_dono), None)
        if animal:
            atendimentos_animal = [at for at in self.atendimentos if at.animal == animal]
            if atendimentos_animal:
                atendimentos_str = "\n".join([f"Data: {at.data}\nSintomas: {at.sintomas}\nDiagnóstico: {at.diagnostico}\n" for at in atendimentos_animal])
                messagebox.showinfo("Atendimentos do Animal", f"Atendimentos do Animal {nome_animal} (CPF do Adotante: {cpf_dono}):\n{atendimentos_str}")
            else:
                messagebox.showinfo("Atendimentos do Animal", f"Nenhum atendimento para o Animal {nome_animal} (CPF do Adotante: {cpf_dono}).")
        else:
            messagebox.showerror("Erro", "Animal não encontrado. Verifique o nome do animal e o CPF do Adotante.")
            
    def atualizar_dono(self):
        cpf = self.cpf_dono_atualizar_entry.get()
        novo_nome = self.novo_nome_dono_entry.get()
        novo_sobrenome = self.novo_sobrenome_dono_entry.get()
        novo_numero_contato = self.novo_numero_contato_dono_entry.get()

        dono = next((d for d in self.donos if d.cpf == cpf), None)

        if dono:
            dono.nome = novo_nome
            dono.sobrenome = novo_sobrenome
            dono.numero_contato = novo_numero_contato
            messagebox.showinfo("Atualização de Dono", "Dados do dono atualizados com sucesso!")
        else:
            messagebox.showerror("Erro", "Dono não encontrado. Verifique o CPF do dono.")
            
    def exibir_lista_adotantes(self):
        lista_adotantes = self.get_lista_donos()
        if lista_adotantes:
            adotantes_info = "\n".join([f"Nome: {nome}, Sobrenome: {sobrenome}, CPF: {cpf}, Contato: {contato}" for nome, sobrenome, cpf, contato in lista_adotantes])
            messagebox.showinfo("Lista de Adotantes", f"Adotantes cadastrados:\n{adotantes_info}")
        else:
            messagebox.showinfo("Lista de Adotantes", "Nenhum adotante cadastrado.")
        
    def atualizar_animal(self):
        nome_animal = self.nome_animal_atualizar_entry.get()
        novo_nome_animal = self.novo_nome_animal_entry.get()
        novo_sexo = self.novo_sexo_entry.get()
        nova_idade = self.nova_idade_entry.get()
        nova_especie = self.nova_especie_entry.get()

        animal = next((a for a in self.animais if a.nome == nome_animal), None)

        if animal:
            animal.nome = novo_nome_animal
            animal.sexo = novo_sexo
            animal.idade = nova_idade
            animal.especie = nova_especie
            messagebox.showinfo("Atualização de Animal", "Dados do animal atualizados com sucesso!")
        else:
            messagebox.showerror("Erro", "Animal não encontrado. Verifique o nome do animal.")

    def criar_interface_dono(self):
        
        label_nome = tk.Label(self.tab_dono, text="> Cadastro de Adotantes")
        label_nome.grid(row=0, column=1)
        # Labels e Entries para cadastrar donos
        label_nome = tk.Label(self.tab_dono, text="Nome:")
        label_nome.grid(row=1, column=0)
        self.nome_entry = tk.Entry(self.tab_dono)
        self.nome_entry.grid(row=1, column=1)

        label_sobrenome = tk.Label(self.tab_dono, text="Sobrenome:")
        label_sobrenome.grid(row=1, column=2)
        self.sobrenome_entry = tk.Entry(self.tab_dono)
        self.sobrenome_entry.grid(row=1, column=3)

        label_cpf = tk.Label(self.tab_dono, text="CPF:")
        label_cpf.grid(row=2, column=0)
        self.cpf_entry = tk.Entry(self.tab_dono)
        self.cpf_entry.grid(row=2, column=1)

        label_numero_contato = tk.Label(self.tab_dono, text="Contato:")
        label_numero_contato.grid(row=2, column=2)
        self.numero_contato_entry = tk.Entry(self.tab_dono)
        self.numero_contato_entry.grid(row=2, column=3)

        # Botões de ação para Adotantes
        btn_cadastrar_dono = tk.Button(self.tab_dono, text="Adicionar", command=self.cadastrar_dono)
        btn_cadastrar_dono.grid(row=3, column=4, padx=9, pady=5)

        # Botão para visualizar animais vinculados a um CPF de adotante
        btn_visualizar_animais_por_cpf = tk.Button(self.tab_dono, text="Pets Adotados", command=self.visualizar_animais_por_cpf)
        btn_visualizar_animais_por_cpf.grid(row=9, column=1)
        
        # Botão para atualizar dados do adotante
        btn_abrir_dialogo_atualizacao = tk.Button(self.tab_dono, text="Atualizar Dados", command=self.abrir_dialogo_atualizacao_dono)
        btn_abrir_dialogo_atualizacao.grid(row=9, column=2, rowspan=6)
        
        # Botão para listar adotantes
        btn_exibir_dono = tk.Button(self.tab_dono, text="Lista de Adotantes", command=self.exibir_lista_adotantes)
        btn_exibir_dono.grid(row=9, column=3, rowspan=6)
        
         # Botão para deletar adotante
        btn_deletar_adotante = tk.Button(self.tab_dono, text="Deletar Adotante", command=self.deletar_adotante)
        btn_deletar_adotante.grid(row=9, column=4)
        
    def abrir_dialogo_atualizacao_dono(self):
        # Criar uma nova janela pop-up para a atualização do adotante
        dialogo_atualizacao_dono = tk.Toplevel(self.tab_dono)
        dialogo_atualizacao_dono.title("Atualizar Dados do Adotante")

        # Labels e Entries para atualizar dados do adotante
        label_cpf_dono_atualizar = tk.Label(dialogo_atualizacao_dono, text="CPF do Dono a Atualizar:")
        label_cpf_dono_atualizar.grid(row=0, column=0)
        self.cpf_dono_atualizar_entry = tk.Entry(dialogo_atualizacao_dono)
        self.cpf_dono_atualizar_entry.grid(row=0, column=1)

        label_novo_nome_dono = tk.Label(dialogo_atualizacao_dono, text="Nome:")
        label_novo_nome_dono.grid(row=1, column=0)
        self.novo_nome_dono_entry = tk.Entry(dialogo_atualizacao_dono)
        self.novo_nome_dono_entry.grid(row=1, column=1)

        label_novo_sobrenome_dono = tk.Label(dialogo_atualizacao_dono, text="Sobrenome:")
        label_novo_sobrenome_dono.grid(row=1, column=2)
        self.novo_sobrenome_dono_entry = tk.Entry(dialogo_atualizacao_dono)
        self.novo_sobrenome_dono_entry.grid(row=1, column=3)

        label_novo_numero_contato_dono = tk.Label(dialogo_atualizacao_dono, text="Novo Contato:")
        label_novo_numero_contato_dono.grid(row=2, column=0)
        self.novo_numero_contato_dono_entry = tk.Entry(dialogo_atualizacao_dono)
        self.novo_numero_contato_dono_entry.grid(row=2, column=1)

        # Botão para atualizar dados do adotante
        btn_atualizar_dono = tk.Button(dialogo_atualizacao_dono, text="Atualizar Dados", command=self.atualizar_dono)
        btn_atualizar_dono.grid(row=3, column=1, columnspan=2, padx=5, pady=5)
            
    def criar_interface_animal(self):
        # Labels e Entries para cadastrar animais
        label_nome_animal = tk.Label(self.tab_animal, text="Apelido:")
        label_nome_animal.grid(row=0, column=0)
        self.nome_animal_entry = tk.Entry(self.tab_animal)
        self.nome_animal_entry.grid(row=0, column=1)

        label_especie = tk.Label(self.tab_animal, text="Espécie:")
        label_especie.grid(row=0, column=2)
        self.especie_entry = tk.Entry(self.tab_animal)
        self.especie_entry.grid(row=0, column=3)
        
        label_raca = tk.Label(self.tab_animal, text="Raça:")
        label_raca.grid(row=1, column=0)
        self.raca_entry = tk.Entry(self.tab_animal)
        self.raca_entry.grid(row=1, column=1)
        
        label_idade = tk.Label(self.tab_animal, text="Idade:")
        label_idade.grid(row=1, column=2)
        self.idade_entry = tk.Entry(self.tab_animal)
        self.idade_entry.grid(row=1, column=3)
        
        label_sexo = tk.Label(self.tab_animal, text="Sexo:")
        label_sexo.grid(row=2, column=0)
        self.sexo_entry = tk.Entry(self.tab_animal)
        self.sexo_entry.grid(row=2, column=1)

        label_dono = tk.Label(self.tab_animal, text="Dono (CPF):")
        label_dono.grid(row=2, column=2)
        self.dono_entry = tk.Entry(self.tab_animal)
        self.dono_entry.grid(row=2, column=3)

        # Botões de ação para Animais
        btn_cadastrar_animal = tk.Button(self.tab_animal, text="Cadastrar Animal", command=self.cadastrar_animal)
        btn_cadastrar_animal.grid(row=3, column=0, columnspan=2)
        
        btn_atualizar_animal = tk.Button(self.tab_animal, text="Atualizar Animal", command=self.atualizar_animal)
        btn_atualizar_animal.grid(row=4, column=0, columnspan=2)

    def criar_interface_atendimento(self):
        # Labels e Entries para cadastrar atendimento veterinário
        label_animal_atendimento = tk.Label(self.tab_atendimento, text="Animal:")
        label_animal_atendimento.grid(row=0, column=0)
        self.animal_atendimento_entry = tk.Entry(self.tab_atendimento)
        self.animal_atendimento_entry.grid(row=0, column=1)

        label_data = tk.Label(self.tab_atendimento, text="Data:")
        label_data.grid(row=1, column=0)
        self.data_entry = tk.Entry(self.tab_atendimento)
        self.data_entry.grid(row=1, column=1)

        label_sintomas = tk.Label(self.tab_atendimento, text="Sintomas:")
        label_sintomas.grid(row=2, column=0)
        self.sintomas_entry = tk.Entry(self.tab_atendimento)
        self.sintomas_entry.grid(row=2, column=1)

        label_diagnostico = tk.Label(self.tab_atendimento, text="Diagnóstico:")
        label_diagnostico.grid(row=3, column=0)
        self.diagnostico_entry = tk.Entry(self.tab_atendimento)
        self.diagnostico_entry.grid(row=3, column=1)

        # Botões de ação para Atendimento Veterinário
        btn_cadastrar_atendimento = tk.Button(self.tab_atendimento, text="Cadastrar Atendimento", command=self.cadastrar_atendimento)
        btn_cadastrar_atendimento.grid(row=4, column=0, columnspan=2)

        # Labels e Entries para visualizar atendimentos por animal e dono
        label_nome_animal_atendimento = tk.Label(self.tab_atendimento, text="Nome do Animal:")
        label_nome_animal_atendimento.grid(row=5, column=0)
        self.nome_animal_atendimento_entry = tk.Entry(self.tab_atendimento)
        self.nome_animal_atendimento_entry.grid(row=5, column=1)

        label_cpf_dono_atendimento = tk.Label(self.tab_atendimento, text="CPF do Dono:")
        label_cpf_dono_atendimento.grid(row=6, column=0)
        self.cpf_dono_atendimento_entry = tk.Entry(self.tab_atendimento)
        self.cpf_dono_atendimento_entry.grid(row=6, column=1)
        
        
        # Botão para visualizar atendimentos por animal e dono
        btn_visualizar_atendimentos = tk.Button(self.tab_atendimento, text="Visualizar Atendimentos", command=self.visualizar_atendimentos_por_animal_e_dono)
        btn_visualizar_atendimentos.grid(row=7, column=0, columnspan=2)

if __name__ == "__main__":
    root = tk.Tk()
    app = CRUDApp(root)
    root.mainloop()
